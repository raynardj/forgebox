from forgebox.treehot import Category, find_ancestor_map
import numpy as np

parent_map = {'AA': 'SOFT_TISSUE',
              'AASTR': 'DIFG',
              'ABC': 'DLBCLNOS',
              'ABL': 'AMLNOS',
              'ACA': 'ADRENAL_GLAND',
              'ACBC': 'BRCA',
              'ACC': 'ADRENAL_GLAND',
              'ACCC': 'SACA',
              'ACLG': 'LGT',
              'ACML': 'MDS/MPN',
              'ACN': 'CUP',
              'ACPG': 'SELT',
              'ACPP': 'CPT',
              'ACRM': 'MEL',
              'ACYC': 'SACA',
              'ADMA': 'BONE',
              'ADNOS': 'CUP',
              'ADPA': 'SKIN',
              'ADRENAL_GLAND': 'TISSUE',
              'AECA': 'SKIN',
              'AFH': 'SOFT_TISSUE',
              'AFX': 'SKIN',
              'AGA': 'BOWEL',
              'AGNG': 'ENCG',
              'AHCD': 'MBN',
              'AIS': 'OTHER',
              'AITL': 'MTNN',
              'ALAL': 'MNM',
              'ALCL': 'MTNN',
              'ALCLALKN': 'ALCL',
              'ALCLALKP': 'ALCL',
              'ALKLBCL': 'MBN',
              'ALT': 'SOFT_TISSUE',
              'ALUCA': 'LNET',
              'AM': 'AMLNOS',
              'AMBL': 'EMBT',
              'AMKL': 'AMLNOS',
              'AML': 'MNM',
              'AMLBCRABL1': 'AMLRGA',
              'AMLCBFBMYH11': 'AMLRGA',
              'AMLCEBPA': 'AMLRGA',
              'AMLDEKNUP214': 'AMLRGA',
              'AMLGATA2MECOM': 'AMLRGA',
              'AMLMD': 'AMLNOS',
              'AMLMLLT3KMT2A': 'AMLRGA',
              'AMLMRC': 'AML',
              'AMLNOS': 'AML',
              'AMLNPM1': 'AMLRGA',
              'AMLRARA': 'AMLRGA',
              'AMLRBM15MKL1': 'AMLRGA',
              'AMLRGA': 'AML',
              'AMLRUNX1': 'AMLRGA',
              'AMLRUNX1RUNX1T1': 'AMLRGA',
              'AMML': 'AMLNOS',
              'AMOL': 'AMLNOS',
              'AMPCA': 'AMPULLA_OF_VATER',
              'AMPULLA_OF_VATER': 'TISSUE',
              'AN': 'SKIN',
              'ANGL': 'MNET',
              'ANGS': 'SOFT_TISSUE',
              'ANKL': 'MTNN',
              'ANM': 'MNGT',
              'ANSC': 'BOWEL',
              'AOAST': 'DIFG',
              'AODG': 'DIFG',
              'APAD': 'BOWEL',
              'APE': 'EPMT',
              'APLPMLRARA': 'AMLRGA',
              'APMF': 'AMLNOS',
              'APTAD': 'SELT',
              'APXA': 'ENCG',
              'ARMM': 'BOWEL',
              'ARMS': 'RMS',
              'ASCT': 'OHNCA',
              'ASM': 'SM',
              'ASPS': 'SOFT_TISSUE',
              'ASTB': 'MNET',
              'ASTR': 'DIFG',
              'ATLL': 'MTNN',
              'ATM': 'MNGT',
              'ATRT': 'EMBT',
              'AUL': 'ALAL',
              'AWDNET': 'GINET',
              'AWM': 'AMLNOS',
              'BA': 'PBS',
              'BCAC': 'SACA',
              'BCC': 'SKIN',
              'BCCA': 'BGCT',
              'BCCP': 'PROSTATE',
              'BCLU': 'MBN',
              'BEC': 'BGCT',
              'BFN': 'BREAST',
              'BGCT': 'BRAIN',
              'BIALCL': 'ALCL',
              'BILIARY_TRACT': 'TISSUE',
              'BIMT': 'BGCT',
              'BL': 'MBN',
              'BLAD': 'BLADDER',
              'BLADDER': 'TISSUE',
              'BLCA': 'BLADDER',
              'BLCLC': 'LCLC',
              'BLL': 'LNM',
              'BLL11Q': 'MBN',
              'BLLBCRABL1': 'BLLRGA',
              'BLLBCRABL1L': 'BLLRGA',
              'BLLETV6RUNX1': 'BLLRGA',
              'BLLHYPER': 'BLLRGA',
              'BLLHYPO': 'BLLRGA',
              'BLLIAMP21': 'BLLRGA',
              'BLLIL3IGH': 'BLLRGA',
              'BLLKMT2A': 'BLLRGA',
              'BLLNOS': 'BLL',
              'BLLRGA': 'BLL',
              'BLLTCF3PBX1': 'BLLRGA',
              'BLPT': 'PT',
              'BLSC': 'BLADDER',
              'BMGCT': 'BGCT',
              'BMGT': 'BGCT',
              'BMT': 'BGCT',
              'BNNOS': 'BREAST',
              'BONE': 'TISSUE',
              'BOWEL': 'TISSUE',
              'BPDCN': 'MNM',
              'BPLL': 'MBN',
              'BPSCC': 'PSCC',
              'BPT': 'PT',
              'BRAIN': 'TISSUE',
              'BRAME': 'BREAST',
              'BRCA': 'BREAST',
              'BRCANOS': 'BRCA',
              'BRCNOS': 'BRCA',
              'BREAST': 'TISSUE',
              'BRSRCC': 'BRCA',
              'BTBEOV': 'BTOV',
              'BTBOV': 'BTOV',
              'BTMOV': 'BTOV',
              'BTOV': 'OVT',
              'BYST': 'BGCT',
              'CABC': 'CERVIX',
              'CACC': 'CERVIX',
              'CAEXPA': 'SACA',
              'CAIS': 'COADREAD',
              'CCBOV': 'OVT',
              'CCE': 'EPMT',
              'CCHDM': 'CHDM',
              'CCHM': 'MMBC',
              'CCLC': 'LCLC',
              'CCM': 'MNGT',
              'CCOC': 'ODGC',
              'CCOV': 'OVT',
              'CCPRC': 'NCCRCC',
              'CCRCC': 'RCC',
              'CCS': 'SOFT_TISSUE',
              'CCSK': 'KIDNEY',
              'CDRCC': 'NCCRCC',
              'CEAD': 'CERVIX',
              'CEAIS': 'CERVIX',
              'CEAS': 'CERVIX',
              'CECC': 'CEAD',
              'CEEN': 'CEAD',
              'CEGCC': 'CERVIX',
              'CELI': 'CERVIX',
              'CELNOS': 'MPN',
              'CEMN': 'CEAD',
              'CEMU': 'CEAD',
              'CENE': 'CERVIX',
              'CERMS': 'CERVIX',
              'CERVIX': 'TISSUE',
              'CESC': 'CERVIX',
              'CESE': 'CEAD',
              'CEVG': 'CEAD',
              'CHBL': 'BONE',
              'CHDM': 'BONE',
              'CHGL': 'MNET',
              'CHL': 'HL',
              'CHLPTLD': 'PTLD',
              'CHM': 'MP',
              'CHOL': 'BILIARY_TRACT',
              'CHOM': 'MNGT',
              'CHOS': 'OS',
              'CHRCC': 'NCCRCC',
              'CHS': 'BONE',
              'CLLSLL': 'MBN',
              'CLNC': 'MNET',
              'CLPDNK': 'MTNN',
              'CM': 'OM',
              'CMC': 'BOWEL',
              'CMCD': 'MCD',
              'CML': 'MPN',
              'CMLBCRABL1': 'CML',
              'CMML': 'MDS/MPN',
              'CMML0': 'CMML',
              'CMML1': 'CMML',
              'CMML2': 'CMML',
              'CMPT': 'NSCLC',
              'CNC': 'MNET',
              'CNL': 'MPN',
              'COAD': 'COADREAD',
              'COADREAD': 'BOWEL',
              'COM': 'MMBC',
              'CPC': 'CPT',
              'CPP': 'CPT',
              'CPT': 'BRAIN',
              'CSCC': 'SKIN',
              'CSCHW': 'SCHW',
              'CSCLC': 'LUNG',
              'CSNOS': 'BRCA',
              'CTAAP': 'APAD',
              'CUP': 'OTHER',
              'CUPNOS': 'CUP',
              'DA': 'SBC',
              'DASTR': 'DIFG',
              'DCIS': 'BREAST',
              'DCS': 'SOFT_TISSUE',
              'DDCHDM': 'CHDM',
              'DDCHS': 'CHS',
              'DDLS': 'LIPO',
              'DES': 'SOFT_TISSUE',
              'DESM': 'MEL',
              'DF': 'SKIN',
              'DFL': 'FL',
              'DFSP': 'SKIN',
              'DIA': 'MNET',
              'DIFG': 'BRAIN',
              'DIG': 'MNET',
              'DIPG': 'DIFG',
              'DLBCLCI': 'MBN',
              'DLBCLNOS': 'MBN',
              'DMBL': 'EMBT',
              'DNT': 'ENCG',
              'DSRCT': 'SOFT_TISSUE',
              'DSTAD': 'STAD',
              'DTE': 'SKIN',
              'EATL': 'MTNN',
              'EBOV': 'OVT',
              'EBVDLBCLNOS': 'MBN',
              'EBVMCU': 'MBN',
              'ECAD': 'CEAD',
              'ECD': 'HDCN',
              'EGC': 'STOMACH',
              'EGCT': 'OTHER',
              'EHAE': 'SOFT_TISSUE',
              'EHCH': 'CHOL',
              'EMALT': 'MZL',
              'EMBC': 'MBC',
              'EMBCA': 'NSGCT',
              'EMBT': 'BRAIN',
              'EMCHS': 'CHS',
              'EMPD': 'SKIN',
              'EMPSGC': 'SKIN',
              'EMYOCA': 'OHNCA',
              'ENCG': 'BRAIN',
              'ENKL': 'MTNN',
              'EOV': 'OVT',
              'EP': 'MBN',
              'EPDCA': 'STOMACH',
              'EPIS': 'SOFT_TISSUE',
              'EPM': 'EPMT',
              'EPMT': 'BRAIN',
              'ERMS': 'RMS',
              'ES': 'BONE',
              'ESCA': 'EGC',
              'ESCC': 'STOMACH',
              'ESMM': 'STOMACH',
              'ESS': 'USARC',
              'ESST': 'SOFT_TISSUE',
              'ET': 'MPN',
              'ETANTR': 'EMBT',
              'ETMF': 'ET',
              'ETPLL': 'TLL',
              'ETT': 'GTD',
              'EVN': 'MNET',
              'EYE': 'TISSUE',
              'FA': 'BFN',
              'FDCS': 'HDCN',
              'FHPTLD': 'PTLD',
              'FHRCC': 'NCCRCC',
              'FIBS': 'SOFT_TISSUE',
              'FIOS': 'OS',
              'FL': 'MBN',
              'FLC': 'LIVER',
              'FRCT': 'HDCN',
              'FT': 'SCST',
              'FTCL': 'MTNN',
              'GB': 'DIFG',
              'GBAD': 'GBC',
              'GBASC': 'GBC',
              'GBC': 'BILIARY_TRACT',
              'GBM': 'GB',
              'GCB': 'DLBCLNOS',
              'GCCAP': 'APAD',
              'GCEMU': 'CEMU',
              'GCLC': 'LCLC',
              'GCT': 'SELT',
              'GCTB': 'BONE',
              'GCTSTM': 'NSGCT',
              'GEJ': 'EGC',
              'GHCD': 'MBN',
              'GINET': 'BOWEL',
              'GINETES': 'STOMACH',
              'GIST': 'SOFT_TISSUE',
              'GMN': 'BGCT',
              'GN': 'PNS',
              'GNBL': 'PNS',
              'GNC': 'ENCG',
              'GNG': 'ENCG',
              'GNOS': 'DIFG',
              'GRC': 'EGC',
              'GRCT': 'SCST',
              'GS': 'SOFT_TISSUE',
              'GSARC': 'GB',
              'GTD': 'UTERUS',
              'HCC': 'LIVER',
              'HCCIHCH': 'LIVER',
              'HCL': 'MBN',
              'HCL-V': 'SBLU',
              'HDCN': 'MNM',
              'HDCS': 'DCS',
              'HEAD_NECK': 'TISSUE',
              'HEMA': 'SOFT_TISSUE',
              'HGBCL': 'MBN',
              'HGBCLMYCBCL2': 'MBN',
              'HGESS': 'ESS',
              'HGGNOS': 'DIFG',
              'HGNEC': 'GINET',
              'HGNEE': 'GINETES',
              'HGNES': 'GINETES',
              'HGNET': 'MBT',
              'HGONEC': 'OOVC',
              'HGSFT': 'OOVC',
              'HGSOC': 'SOC',
              'HGSOS': 'OS',
              'HHV8DLBCL': 'MBN',
              'HL': 'LNM',
              'HMBL': 'MBT',
              'HNMASC': 'SACA',
              'HNMUCM': 'HEAD_NECK',
              'HNNE': 'OHNCA',
              'HNSC': 'HEAD_NECK',
              'HNSCUP': 'HNSC',
              'HPCCNS': 'MNGT',
              'HPHSC': 'HNSC',
              'HS': 'HDCN',
              'HSTCL': 'MTNN',
              'HTAT': 'THYROID',
              'HVLL': 'MTNN',
              'IAMPCA': 'AMPCA',
              'IBC': 'BREAST',
              'ICEMU': 'CEMU',
              'ICPN': 'BILIARY_TRACT',
              'IDC': 'BRCA',
              'IDCS': 'HDCN',
              'IDCT': 'HDCN',
              'IFS': 'SOFT_TISSUE',
              'IHCH': 'CHOL',
              'IHM': 'MP',
              'ILC': 'BRCA',
              'IMMC': 'BRCA',
              'IMPTLD': 'PTLD',
              'IMS': 'SOFT_TISSUE',
              'IMT': 'SOFT_TISSUE',
              'IMTB': 'BLADDER',
              'IMTL': 'LUNG',
              'INTS': 'SOFT_TISSUE',
              'IOPN': 'PACT',
              'IPMN': 'PACT',
              'IPN': 'BILIARY_TRACT',
              'ISFN': 'FL',
              'ISM': 'SM',
              'ISMCL': 'MCL',
              'ISTAD': 'STAD',
              'ITLPDGI': 'MTNN',
              'ITPN': 'PACT',
              'IUP': 'BLADDER',
              'IVBCL': 'MBN',
              'JMML': 'MDS/MPN',
              'JSCB': 'BREAST',
              'JXG': 'HDCN',
              'KIDNEY': 'TISSUE',
              'LAIS': 'LUNG',
              'LAM': 'LUNG',
              'LAMN': 'BOWEL',
              'LATL': 'LYMPH',
              'LBGN': 'LYMPH',
              'LBLIRF4': 'MBN',
              'LCH': 'HDCN',
              'LCIS': 'BREAST',
              'LCLC': 'NSCLC',
              'LCS': 'HDCN',
              'LDCHL': 'CHL',
              'LDD': 'MNET',
              'LECLC': 'LCLC',
              'LGCOS': 'OS',
              'LGESS': 'ESS',
              'LGFMS': 'SOFT_TISSUE',
              'LGGNOS': 'ENCG',
              'LGNET': 'MBT',
              'LGSOC': 'SOC',
              'LGT': 'EYE',
              'LIAD': 'LIVER',
              'LIAS': 'LIVER',
              'LIHB': 'LIVER',
              'LIMNET': 'LIVER',
              'LIPO': 'SOFT_TISSUE',
              'LIVER': 'TISSUE',
              'LM': 'SOFT_TISSUE',
              'LMS': 'SOFT_TISSUE',
              'LNET': 'LUNG',
              'LNM': 'LYMPH',
              'LPL': 'MBN',
              'LRCHL': 'CHL',
              'LUACC': 'SGTTL',
              'LUAD': 'NSCLC',
              'LUAS': 'NSCLC',
              'LUCA': 'LNET',
              'LUMEC': 'SGTTL',
              'LUNE': 'LNET',
              'LUNG': 'TISSUE',
              'LUPC': 'NSCLC',
              'LUSC': 'NSCLC',
              'LXSC': 'HNSC',
              'LYG': 'MBN',
              'LYMPH': 'TISSUE',
              'LYP': 'PCLPD',
              'MAAP': 'APAD',
              'MAC': 'SKIN',
              'MACR': 'COADREAD',
              'MAMPCA': 'AMPCA',
              'MASC': 'EMBC',
              'MASCC': 'EMBC',
              'MATPL': 'MYELOID',
              'MBC': 'BREAST',
              'MBEN': 'EMBT',
              'MBGN': 'MYELOID',
              'MBL': 'EMBT',
              'MBN': 'NHL',
              'MBOV': 'OVT',
              'MBT': 'BRAIN',
              'MCBCL': 'MBN',
              'MCC': 'SKIN',
              'MCCE': 'CERVIX',
              'MCCHL': 'CHL',
              'MCD': 'MNM',
              'MCHS': 'CHS',
              'MCHSCNS': 'MBT',
              'MCL': 'MBN',
              'MCN': 'PACT',
              'MCS': 'MMBC',
              'MCSL': 'MCD',
              'MDEP': 'EMBT',
              'MDLC': 'BRCA',
              'MDS': 'MNM',
              'MDS/MPN': 'MNM',
              'MDSEB': 'MDS',
              'MDSEB1': 'MDSEB',
              'MDSEB2': 'MDSEB',
              'MDSID5Q': 'MDS',
              'MDSMD': 'MDS',
              'MDSMPNRST': 'MDS/MPN',
              'MDSMPNU': 'MDS/MPN',
              'MDSRS': 'MDS',
              'MDSRSMD': 'MDSRS',
              'MDSRSSLD': 'MDSRS',
              'MDSSLD': 'MDS',
              'MDSU': 'MDS',
              'MEITL': 'MTNN',
              'MEL': 'SKIN',
              'MELC': 'PCNSMT',
              'MF': 'SOFT_TISSUE',
              'MFH': 'SOFT_TISSUE',
              'MFS': 'SOFT_TISSUE',
              'MGCT': 'NSGCT',
              'MGST': 'SOFT_TISSUE',
              'MGUS': 'MBN',
              'MGUSIGA': 'MGUS',
              'MGUSIGG': 'MGUS',
              'MGUSIGM': 'MGUS',
              'MHCD': 'MBN',
              'MIDD': 'MBN',
              'MIDDA': 'MIDD',
              'MIDDO': 'MIDD',
              'MIXED': 'OTHER',
              'MLADS': 'MPRDS',
              'MLNER': 'MNM',
              'MLNFGFR1': 'MLNER',
              'MLNPCM1JAK2': 'MLNER',
              'MLNPDGFRA': 'MLNER',
              'MLNPDGFRB': 'MLNER',
              'MLYM': 'MBT',
              'MMB': 'EMBT',
              'MMBC': 'MBC',
              'MMBL': 'EMBT',
              'MNET': 'BRAIN',
              'MNG': 'MNGT',
              'MNGLP': 'MNM',
              'MNGT': 'BRAIN',
              'MNM': 'MYELOID',
              'MOV': 'OVT',
              'MP': 'GTD',
              'MPALBCRABL1': 'ALAL',
              'MPALBNOS': 'ALAL',
              'MPALKMT2A': 'ALAL',
              'MPALTNOS': 'ALAL',
              'MPC': 'SOFT_TISSUE',
              'MPE': 'EPMT',
              'MPN': 'MNM',
              'MPNST': 'NST',
              'MPNU': 'MPN',
              'MPRDS': 'AML',
              'MPT': 'PT',
              'MPTLD': 'PTLD',
              'MRC': 'NCCRCC',
              'MRLS': 'LIPO',
              'MRT': 'KIDNEY',
              'MRTL': 'LIVER',
              'MS': 'AML',
              'MSCC': 'EMBC',
              'MSCHW': 'SCHW',
              'MSTAD': 'STAD',
              'MT': 'MBT',
              'MTNN': 'NHL',
              'MTSCC': 'NCCRCC',
              'MUCC': 'SACA',
              'MUP': 'MEL',
              'MXOV': 'OVT',
              'MYCF': 'MTNN',
              'MYCHS': 'CHS',
              'MYEC': 'SACA',
              'MYELOID': 'TISSUE',
              'MYXO': 'SOFT_TISSUE',
              'MZL': 'MBN',
              'NBL': 'PNS',
              'NCCRCC': 'RCC',
              'NECNOS': 'CUP',
              'NETNOS': 'CUP',
              'NFIB': 'NST',
              'NHL': 'LNM',
              'NKCLL': 'TLL',
              'NLPHL': 'HL',
              'NMCHN': 'OHNCA',
              'NMZL': 'MZL',
              'NPC': 'HEAD_NECK',
              'NPTLTFH': 'MTNN',
              'NSCHL': 'CHL',
              'NSCLC': 'LUNG',
              'NSCLCPD': 'NSCLC',
              'NSGCT': 'TESTIS',
              'NST': 'PNS',
              'NUTCL': 'NSCLC',
              'OAST': 'DIFG',
              'OAT': 'THYROID',
              'OCNOS': 'OOVC',
              'OCS': 'OVT',
              'OCSC': 'HNSC',
              'ODG': 'DIFG',
              'ODGC': 'OHNCA',
              'ODYS': 'OGCT',
              'OEC': 'OGCT',
              'OFMT': 'MYXO',
              'OGBL': 'SCST',
              'OGCT': 'OVARY',
              'OHNCA': 'HEAD_NECK',
              'OIMT': 'OGCT',
              'OM': 'EYE',
              'OMGCT': 'OGCT',
              'OMT': 'OGCT',
              'ONBL': 'EMBT',
              'OOVC': 'OVARY',
              'OPE': 'OGCT',
              'OPHSC': 'HNSC',
              'OS': 'BONE',
              'OSACA': 'SACA',
              'OSGCT': 'UCP',
              'OSMAD': 'OVT',
              'OSMBT': 'OVT',
              'OSMCA': 'OVT',
              'OSOS': 'OS',
              'OTHER': 'TISSUE',
              'OUSARC': 'USARC',
              'OUTT': 'UTERUS',
              'OVARY': 'TISSUE',
              'OVT': 'OVARY',
              'OYST': 'OGCT',
              'PAAC': 'PANCREAS',
              'PAAD': 'PANCREAS',
              'PAASC': 'PANCREAS',
              'PAC': 'SACA',
              'PACT': 'PANCREAS',
              'PADA': 'SACA',
              'PAMPCA': 'AMPCA',
              'PANCREAS': 'TISSUE',
              'PANET': 'PANCREAS',
              'PAOS': 'OS',
              'PAST': 'ENCG',
              'PB': 'PANCREAS',
              'PBL': 'PINT',
              'PBS': 'BREAST',
              'PBT': 'MBT',
              'PCAECTCL': 'MTNN',
              'PCALCL': 'PCLPD',
              'PCATCL': 'MTNN',
              'PCFCL': 'MBN',
              'PCGDTCL': 'MTNN',
              'PCGP': 'SELT',
              'PCLBCLLT': 'MBN',
              'PCLPD': 'MTNN',
              'PCM': 'MBN',
              'PCNSL': 'MBN',
              'PCNSM': 'PCNSMT',
              'PCNSMT': 'BRAIN',
              'PCSMTPLD': 'MTNN',
              'PD': 'DCIS',
              'PDC': 'CUP',
              'PECOMA': 'SOFT_TISSUE',
              'PEL': 'MBN',
              'PEMESO': 'PERITONEUM',
              'PENIS': 'TISSUE',
              'PEOS': 'OS',
              'PERITONEUM': 'TISSUE',
              'PERL': 'AMLNOS',
              'PGNG': 'SOFT_TISSUE',
              'PGNT': 'MNET',
              'PHC': 'ADRENAL_GLAND',
              'PHCH': 'CHOL',
              'PHM': 'MP',
              'PHPTLD': 'PTLD',
              'PINC': 'PINT',
              'PINT': 'BRAIN',
              'PLBL': 'MBN',
              'PLBMESO': 'PLMESO',
              'PLEMESO': 'PLMESO',
              'PLEURA': 'TISSUE',
              'PLLS': 'LIPO',
              'PLMESO': 'PLEURA',
              'PLRMS': 'RMS',
              'PLSMESO': 'PLMESO',
              'PMA': 'ENCG',
              'PMBL': 'MBN',
              'PMF': 'MPN',
              'PMFOFS': 'PMF',
              'PMFPES': 'PMF',
              'PMHE': 'SOFT_TISSUE',
              'PNET': 'EMBT',
              'PNS': 'TISSUE',
              'POCA': 'SKIN',
              'PORO': 'SKIN',
              'PPB': 'LUNG',
              'PPCT': 'SKIN',
              'PPM': 'MNGT',
              'PPTID': 'PINT',
              'PPTLD': 'PTLD',
              'PRAD': 'PROSTATE',
              'PRCC': 'NCCRCC',
              'PRNE': 'PROSTATE',
              'PRNET': 'MBT',
              'PROSTATE': 'TISSUE',
              'PRSC': 'PROSTATE',
              'PRSCC': 'PROSTATE',
              'PSC': 'PACT',
              'PSCC': 'PENIS',
              'PSEC': 'PERITONEUM',
              'PSTAD': 'STAD',
              'PSTT': 'GTD',
              'PT': 'BFN',
              'PTAD': 'SELT',
              'PTCA': 'SELT',
              'PTCL': 'MTNN',
              'PTCY': 'SELT',
              'PTES': 'EPIS',
              'PTFL': 'MBN',
              'PTH': 'HEAD_NECK',
              'PTHC': 'PTH',
              'PTLD': 'LNM',
              'PTPR': 'PINT',
              'PV': 'MPN',
              'PVMF': 'PV',
              'PXA': 'ENCG',
              'RAML': 'NCCRCC',
              'RAS': 'SOFT_TISSUE',
              'RBL': 'EYE',
              'RCC': 'KIDNEY',
              'RCSNOS': 'SOFT_TISSUE',
              'RCYC': 'MDS',
              'RDD': 'HDCN',
              'READ': 'COADREAD',
              'RGNT': 'MNET',
              'RHM': 'MNGT',
              'RLCLC': 'LCLC',
              'RMS': 'SOFT_TISSUE',
              'RNET': 'KIDNEY',
              'ROCY': 'NCCRCC',
              'RSCC': 'NCCRCC',
              'RWDNET': 'GINET',
              'SAAD': 'SACA',
              'SACA': 'HEAD_NECK',
              'SARCL': 'LUNG',
              'SARCNOS': 'SOFT_TISSUE',
              'SBC': 'BOWEL',
              'SBL': 'HEAD_NECK',
              'SBLU': 'MBN',
              'SBMOV': 'OVT',
              'SBOV': 'OVT',
              'SBWDNET': 'GINET',
              'SCB': 'BLADDER',
              'SCBC': 'BLADDER',
              'SCCE': 'CERVIX',
              'SCCNOS': 'CUP',
              'SCCO': 'OVT',
              'SCCRCC': 'CCRCC',
              'SCEMU': 'CEMU',
              'SCGBC': 'GBC',
              'SCGBM': 'GB',
              'SCHW': 'NST',
              'SCLC': 'LNET',
              'SCLG': 'LGT',
              'SCOAH': 'SELT',
              'SCOS': 'OS',
              'SCRMS': 'RMS',
              'SCSRMS': 'RMS',
              'SCST': 'OVARY',
              'SCT': 'SCST',
              'SCUP': 'CUP',
              'SDCA': 'SACA',
              'SDRPL': 'SBLU',
              'SEBA': 'SKIN',
              'SEBVTLC': 'MTNN',
              'SECOS': 'OS',
              'SEF': 'FIBS',
              'SELT': 'BRAIN',
              'SEM': 'TESTIS',
              'SFT': 'SOFT_TISSUE',
              'SFTCNS': 'MNGT',
              'SGAD': 'SKIN',
              'SGO': 'SACA',
              'SGTTL': 'NSCLC',
              'SIC': 'BOWEL',
              'SKAC': 'SKIN',
              'SKCM': 'MEL',
              'SKCN': 'MEL',
              'SKIN': 'TISSUE',
              'SKLMM': 'MEL',
              'SLCT': 'SCST',
              'SM': 'MCD',
              'SMAHN': 'SM',
              'SMMCL': 'SM',
              'SMN': 'STOMACH',
              'SMZL': 'MZL',
              'SNA': 'OHNCA',
              'SNSC': 'HNSC',
              'SNUC': 'OHNCA',
              'SOC': 'OVT',
              'SOFT_TISSUE': 'TISSUE',
              'SPB': 'MBN',
              'SPC': 'BRCA',
              'SPCC': 'NSCLC',
              'SPDAC': 'USTAD',
              'SPIR': 'SKIN',
              'SPN': 'PANCREAS',
              'SPTCL': 'MTNN',
              'SPZM': 'MEL',
              'SRAP': 'APAD',
              'SRCBC': 'BLADDER',
              'SRCC': 'NCCRCC',
              'SRCCR': 'COADREAD',
              'SS': 'MTNN',
              'SSM': 'SM',
              'SSRCC': 'USTAD',
              'STAD': 'EGC',
              'STAS': 'EGC',
              'STMYEC': 'SOFT_TISSUE',
              'STOMACH': 'TISSUE',
              'STSC': 'EGC',
              'SUBE': 'EPMT',
              'SWDNET': 'GINETES',
              'SYNS': 'SOFT_TISSUE',
              'TAC': 'BOWEL',
              'TAM': 'MPRDS',
              'TAML': 'TMN',
              'TCCA': 'NSGCT',
              'TEOS': 'OS',
              'TESTIS': 'TISSUE',
              'TET': 'THYMUS',
              'TGCT': 'SOFT_TISSUE',
              'THAP': 'THYROID',
              'THFO': 'WDTC',
              'THHC': 'THYROID',
              'THME': 'THYROID',
              'THPA': 'WDTC',
              'THPD': 'THYROID',
              'THRLBCL': 'MBN',
              'THYC': 'TET',
              'THYM': 'TET',
              'THYMUS': 'TISSUE',
              'THYROID': 'TISSUE',
              'TISSUE': None,
              'TLGL': 'MTNN',
              'TLL': 'LNM',
              'TLYM': 'TESTIS',
              'TMDS': 'TMN',
              'TMESO': 'TESTIS',
              'TMN': 'AML',
              'TNET': 'THYMUS',
              'TPLL': 'MTNN',
              'TRCC': 'NCCRCC',
              'TSCST': 'TESTIS',
              'TSTAD': 'STAD',
              'TT': 'NSGCT',
              'TYST': 'NSGCT',
              'UA': 'URCA',
              'UAD': 'UCA',
              'UAS': 'USARC',
              'UASC': 'UCEC',
              'UCA': 'BLADDER',
              'UCCA': 'GTD',
              'UCCC': 'UCEC',
              'UCEC': 'UTERUS',
              'UCP': 'PANCREAS',
              'UCS': 'UCEC',
              'UCU': 'UCA',
              'UDDC': 'UCEC',
              'UDMN': 'CUP',
              'UEC': 'UCEC',
              'UELMS': 'USMT',
              'UESL': 'LIVER',
              'ULM': 'USMT',
              'ULMS': 'USMT',
              'UM': 'OM',
              'UMC': 'UCEC',
              'UMEC': 'UCEC',
              'UMLMS': 'USMT',
              'UMNC': 'UCEC',
              'UNEC': 'UCEC',
              'UPA': 'BLADDER',
              'UPDC': 'UCEC',
              'UPECOMA': 'USARC',
              'URCA': 'BLADDER',
              'URCC': 'NCCRCC',
              'URMM': 'BLADDER',
              'USARC': 'UTERUS',
              'USC': 'UCEC',
              'USCC': 'UCA',
              'USMT': 'USARC',
              'USTAD': 'EGC',
              'USTUMP': 'USMT',
              'UTERUS': 'TISSUE',
              'UTUC': 'BLADDER',
              'UUC': 'UCEC',
              'UUS': 'USARC',
              'VA': 'VULVA',
              'VDYS': 'VGCT',
              'VGCE': 'CERVIX',
              'VGCT': 'VULVA',
              'VIMT': 'VGCT',
              'VMA': 'VULVA',
              'VMGCT': 'VGCT',
              'VMM': 'VULVA',
              'VMT': 'VGCT',
              'VOEC': 'VGCT',
              'VPDC': 'VULVA',
              'VPE': 'VGCT',
              'VPSCC': 'PSCC',
              'VSC': 'VULVA',
              'VULVA': 'TISSUE',
              'VYST': 'VGCT',
              'WDLS': 'LIPO',
              'WDTC': 'THYROID',
              'WM': 'LPL',
              'WPSCC': 'PSCC',
              'WT': 'KIDNEY'}

def test_treehot():
    ancestor_map = dict((name, find_ancestor_map(name, parent_map)) for name in parent_map.keys())
    cate = Category(list(set(list(i for i in parent_map.values() if i is not None)+list(parent_map.keys()))))
    y = cate.tree_hot("CMLBCRABL1", ancestor_map)
    
    assert y.sum()==6
    
