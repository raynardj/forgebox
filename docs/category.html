---

title: Categorical Transformation for DL


keywords: fastai
sidebar: home_sidebar

summary: "a list of things to categoryical transformation"
description: "a list of things to categoryical transformation"
nb_path: "nbs/53_category.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/53_category.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imports">Imports<a class="anchor-link" href="#Imports"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="C2I" class="doc_header"><code>class</code> <code>C2I</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/category.py#L15" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>C2I</code>(<strong><code>arr</code></strong>:<code>Iterable</code>[<code>T_co</code>], <strong><code>pad_mst</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Category to indices</p>
<blockquote><blockquote><blockquote><p>c2i = C2I(
        ["class 1", "class 2", ..., "class n"],
        pad_mst=True,
        )
c2i[["class 2", "class 5"]]
[0] array([2,3])</p>
</blockquote>
</blockquote>
</blockquote>
<p>If the indices you put in the slicing is a np.ndarray
    a verctorized function will be used</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Category" class="doc_header"><code>class</code> <code>Category</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/category.py#L68" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Category</code>(<strong><code>arr</code></strong>:<code>Iterable</code>[<code>T_co</code>], <strong><code>pad_mst</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Manage categorical translations
c = Category(
        ["class 1", "class 2", ..., "class n"],
        pad_mst=True,)</p>
<p>c.c2i[["class 3","class 6"]]
c.i2c[[3, 2, 1]]</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TreeCategory" class="doc_header"><code>class</code> <code>TreeCategory</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/category.py#L114" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TreeCategory</code>(<strong><code>parent_map</code></strong>:<code>Dict</code>[<code>str</code>, <code>str</code>], <strong><code>pad_mst</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/forgebox/category.html#Category"><code>Category</code></a></p>
</blockquote>
<p>Manage categorical translations
c = Category(
        ["class 1", "class 2", ..., "class n"],
        pad_mst=True,)</p>
<p>c.c2i[["class 3","class 6"]]
c.i2c[[3, 2, 1]]</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Indexing-forward-and-backward">Indexing forward and backward<a class="anchor-link" href="#Indexing-forward-and-backward"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cates</span> <span class="o">=</span> <span class="n">Category</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;Cate_</span><span class="si">{</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cates</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Category Manager with 50</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cates</span><span class="o">.</span><span class="n">i2c</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Cate_1&#39;, &#39;Cate_2&#39;, &#39;Cate_3&#39;, &#39;Cate_4&#39;, &#39;Cate_5&#39;], dtype=&#39;&lt;U7&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Indices-to-categories">Indices to categories<a class="anchor-link" href="#Indices-to-categories"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">cates</span><span class="o">.</span><span class="n">i2c</span><span class="p">[</span><span class="n">test_c</span><span class="p">]</span>
<span class="n">labels</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Cate_3&#39;, &#39;Cate_21&#39;, &#39;Cate_41&#39;, &#39;Cate_29&#39;, &#39;Cate_3&#39;, &#39;Cate_5&#39;,
       &#39;Cate_5&#39;, &#39;Cate_40&#39;, &#39;Cate_3&#39;, &#39;Cate_24&#39;, &#39;Cate_10&#39;, &#39;Cate_19&#39;,
       &#39;Cate_37&#39;, &#39;Cate_45&#39;, &#39;Cate_35&#39;, &#39;Cate_36&#39;, &#39;Cate_28&#39;, &#39;Cate_8&#39;,
       &#39;Cate_13&#39;, &#39;Cate_23&#39;], dtype=&#39;&lt;U7&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Category-to-indices">Category to indices<a class="anchor-link" href="#Category-to-indices"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cates</span><span class="o">.</span><span class="n">c2i</span><span class="p">[</span><span class="n">labels</span><span class="p">[:</span><span class="mi">20</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 2, 20, 40, 28,  2,  4,  4, 39,  2, 23,  9, 18, 36, 44, 34, 35, 27,
        7, 12, 22])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using vectorized function</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">indices_generated</span> <span class="o">=</span> <span class="n">cates</span><span class="o">.</span><span class="n">c2i</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 59.8 ms, sys: 2.67 ms, total: 62.4 ms
Wall time: 62.4 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the original python function</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">indices_generated2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cates</span><span class="o">.</span><span class="n">c2i</span><span class="o">.</span><span class="n">get_int</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 102 ms, sys: 2.31 ms, total: 104 ms
Wall time: 104 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Transform forward and backward and check fidelity</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">cates</span><span class="o">.</span><span class="n">c2i</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span><span class="o">==</span><span class="n">test_c</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="With-missing-tokens">With missing tokens<a class="anchor-link" href="#With-missing-tokens"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can set pad_mst to True to manage missing token</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nt</span> <span class="o">=</span> <span class="n">Category</span><span class="p">(</span><span class="s2">&quot;ATCG&quot;</span><span class="p">,</span> <span class="n">pad_mst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Categories-to-indices">Categories to indices<a class="anchor-link" href="#Categories-to-indices"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nt</span><span class="o">.</span><span class="n">c2i</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;AAACCTTATTGCAGCOAAT&quot;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1, 1, 3, 3, 2, 2, 1, 2, 2, 4, 3, 1, 4, 3, 0, 1, 1, 2])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Indices-to-categories">Indices to categories<a class="anchor-link" href="#Indices-to-categories"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nt</span><span class="o">.</span><span class="n">i2c</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;C&#39;, &#39;C&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;G&#39;, &#39;C&#39;, &#39;A&#39;, &#39;G&#39;,
       &#39;C&#39;, &#39;[MST]&#39;, &#39;A&#39;, &#39;A&#39;, &#39;T&#39;], dtype=&#39;&lt;U5&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-save-and-load">Data save and load<a class="anchor-link" href="#Data-save-and-load"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save-categories">Save categories<a class="anchor-link" href="#Save-categories"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;atcg.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-categories">Load categories<a class="anchor-link" href="#Load-categories"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">Category</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;atcg.json&quot;</span><span class="p">)</span>
<span class="n">cm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Category Manager with 5</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tree-data">Tree data<a class="anchor-link" href="#Tree-data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometime the target should be treated like a tree structure multi-hotting, not one-hot encoding, the benifit of such operation is explained in this <a href="https://colab.research.google.com/github/raynardj/python4ml/blob/master/experiments/treehot_encoding.ipynb">colab notebook</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">tree_str</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://oncotree.mskcc.org/api/tumorTypes/tree?&amp;version=oncotree_latest_stable&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tree_str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parent_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">get_pairs</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
        <span class="n">parent_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">):</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">)})</span>
    <span class="k">if</span> <span class="s2">&quot;children&quot;</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;children&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">get_pairs</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

<span class="n">get_pairs</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;TISSUE&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_category</span> <span class="o">=</span> <span class="n">TreeCategory</span><span class="p">(</span><span class="n">parent_map</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_category</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Tree Category(869):
	self.tree_hot(&#34;name&#34;)	self.ancestor_map	self.depth_map_array</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can transform the category data into the following multihot hierachical encoding vector.</p>
<p>The rest is good old BCELoss</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_category</span><span class="o">.</span><span class="n">tree_hot</span><span class="p">(</span><span class="s2">&quot;NCCRCC&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_category</span><span class="o">.</span><span class="n">depth_map_array</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 2, 3, 4, 4, 4, 3, 4, 4, 5, 5, 4, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4,
       4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 2, 3,
       4, 5, 5, 5, 5, 5, 5, 4, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 4, 5, 6,
       6, 7, 7, 6, 6, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
       7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 6, 6, 6, 6, 7, 6,
       7, 7, 6, 6, 7, 7, 7, 6, 7, 7, 5, 6, 6, 6, 6, 7, 7, 7, 6, 6, 6, 6,
       6, 6, 6, 6, 6, 6, 6, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5,
       6, 6, 6, 6, 4, 5, 5, 3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 3, 4, 3, 4, 3, 4, 4, 4, 4, 4, 2, 3,
       3, 3, 4, 4, 3, 3, 3, 3, 2, 3, 4, 4, 4, 2, 3, 3, 3, 3, 4, 3, 3, 3,
       4, 4, 4, 4, 4, 3, 2, 3, 4, 4, 4, 3, 3, 4, 4, 4, 3, 2, 3, 3, 4, 3,
       3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 4, 3, 3, 4, 5, 5, 5, 4, 3,
       3, 4, 5, 5, 5, 4, 5, 5, 5, 2, 3, 3, 3, 4, 3, 4, 4, 4, 4, 4, 4, 3,
       4, 5, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
       3, 2, 3, 4, 4, 3, 3, 4, 4, 2, 3, 4, 4, 4, 2, 3, 4, 4, 3, 2, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 5, 5, 5, 4, 4, 4, 4, 3, 3, 2,
       3, 3, 3, 4, 4, 5, 5, 4, 3, 2, 3, 4, 4, 4, 4, 3, 3, 3, 4, 3, 3, 3,
       3, 4, 4, 4, 4, 3, 3, 3, 4, 4, 4, 4, 4, 2, 3, 3, 4, 4, 3, 4, 4, 4,
       4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 2, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3,
       2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, 3, 3, 3, 3, 4, 2, 3, 4, 4,
       4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4,
       5, 5, 5, 4, 4, 4, 4, 4, 3, 4, 4, 4, 3, 4, 4, 3, 4, 4, 4, 4, 4, 4,
       4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4,
       4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4,
       4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 2, 3, 3, 3, 2, 3, 3, 3, 3,
       3, 2, 3, 4, 4, 4, 4, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 4, 4, 5, 5, 5,
       5, 5, 4, 4, 3, 3, 3, 3, 3, 2, 3, 4, 4, 4, 2, 3, 4, 4, 5, 5, 5, 5,
       5, 4, 4, 5, 5, 4, 4, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3,
       4, 5, 5, 5, 4, 4, 4, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2,
       3, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2,
       3, 3, 2, 3, 3, 4, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, 5, 6, 6,
       5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 5, 5, 5,
       5, 5, 5, 5, 4, 4, 5, 5, 5, 5, 5, 4, 5, 5, 5, 6, 6, 6, 5, 5, 4, 5,
       5, 6, 5, 6, 5, 6, 6, 5, 5, 5, 6, 4, 4, 5, 5, 5, 5, 4, 5, 6, 6, 5,
       6, 6, 5, 5, 5, 5, 5, 4, 5, 5, 6, 6, 6, 6, 6, 5, 3, 2, 3, 3, 4, 4,
       4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 3, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
       5, 5, 5, 4, 5, 3, 3, 3, 3, 2, 3, 4, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4,
       5, 5, 4, 3, 3, 3, 4, 4, 4, 3, 3])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the above array, you can achieve many tasks.</p>
<p>eg. you can calc accuracy, loss, f1 for each level</p>
<div class="highlight"><pre><span></span><span class="n">crit</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitLoss</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="p">(</span><span class="n">y_</span><span class="o">&gt;.</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">crit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_</span><span class="p">)</span>

<span class="n">level_map</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">tree_category</span><span class="o">.</span><span class="n">depth_map_array</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>

<span class="c1"># calc metrics for level2, level3, level4</span>
<span class="n">loss_l</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">acc_l</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
    <span class="n">y_level</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">level_map</span><span class="o">==</span><span class="n">level</span><span class="p">]</span>
    <span class="n">y_hat_level</span> <span class="o">=</span> <span class="n">y_</span><span class="p">[</span><span class="n">level_map</span><span class="o">==</span><span class="n">level</span><span class="p">]</span>
    <span class="n">loss_l</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span><span class="p">(</span><span class="n">y_level</span><span class="p">,</span> <span class="n">y_hat_level</span><span class="p">)</span>
    <span class="n">acc_l</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">y_level</span><span class="p">,</span> <span class="n">y_hat_level</span><span class="p">)</span>
</pre></div>
<p>Or assign different weights to different level of loss, etc.</p>
<p>Visualize level for first 100 categories</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tree_category</span><span class="o">.</span><span class="n">depth_map_array</span><span class="o">==</span><span class="n">i</span>
                  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">tree_category</span><span class="o">.</span><span class="n">depth_map_array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)))[:,:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x1c375535d0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

