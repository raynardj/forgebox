---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/15_loopstack.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="15-LoopStack">15 LoopStack<a class="anchor-link" href="#15-LoopStack">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To run through iterations quickly, we use the california housing data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets.california_housing</span> <span class="k">import</span> <span class="n">fetch_california_housing</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">fetch_california_housing</span><span class="p">(</span><span class="n">return_X_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((20640, 8), (20640,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Normalized Data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Preview x input</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">denorm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="n">m</span>

<span class="n">x_normed</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_normed</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">())(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_normed</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span><span class="n">x_normed</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>\
<span class="n">y_normed</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span><span class="n">y_normed</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([ 0.,  0.,  0., -0., -0.,  0., -0., -0.], dtype=float16),
 array([1., 1., 1., 1., 1., 1., 1., 1.]),
 0.0,
 1.0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_normed</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x1a1c059b10&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_normed</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 2.34476576,  0.98214266,  0.62855945, ..., -0.04959654,
         1.05254828, -1.32783522],
       [ 2.33223796, -0.60701891,  0.32704136, ..., -0.09251223,
         1.04318455, -1.32284391],
       [ 1.7826994 ,  1.85618152,  1.15562047, ..., -0.02584253,
         1.03850269, -1.33282653],
       ...,
       [-1.14259331, -0.92485123, -0.09031802, ..., -0.0717345 ,
         1.77823747, -0.8237132 ],
       [-1.05458292, -0.84539315, -0.04021111, ..., -0.09122515,
         1.77823747, -0.87362627],
       [-0.78012947, -1.00430931, -0.07044252, ..., -0.04368215,
         1.75014627, -0.83369581]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_event" class="doc_header"><code>create_event</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_event</code>(<strong><code>event_name</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="events" class="doc_header"><code>events</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>events</code>(<strong>*<code>enames</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LoopStack" class="doc_header"><code>class</code> <code>LoopStack</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LoopStack</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>) :: <a href="/forgebox/loop#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRAIN_EVENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DATA_PROCESS&quot;</span><span class="p">,</span><span class="s2">&quot;FORWARD&quot;</span><span class="p">,</span><span class="s2">&quot;LOSS_CALC&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BACKWARD&quot;</span><span class="p">,</span><span class="s2">&quot;OPT_STEP&quot;</span><span class="p">,</span><span class="s2">&quot;METRICS&quot;</span><span class="p">]</span>
<span class="n">EVAL_EVENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DATA_PROCESS&quot;</span><span class="p">,</span><span class="s2">&quot;EVAL_WRAP&quot;</span><span class="p">,</span><span class="s2">&quot;FORWARD&quot;</span><span class="p">,</span><span class="s2">&quot;LOSS_CALC&quot;</span><span class="p">,</span><span class="s2">&quot;METRICS&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_callbacks" class="doc_header"><code>train_callbacks</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_callbacks</code>(<strong><code>loop</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_single_forward" class="doc_header"><code>train_single_forward</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L76" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_single_forward</code>(<strong><code>metric_func</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TrainLoop" class="doc_header"><code>class</code> <code>TrainLoop</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L102" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TrainLoop</code>(<strong><code>data_iter</code></strong>, <strong><code>model</code></strong>=<em><code>[]</code></em>, <strong><code>opt</code></strong>=<em><code>[]</code></em>, <strong><code>loss_func</code></strong>=<em><code>[]</code></em>, <strong><code>loss</code></strong>=<em><code>[]</code></em>, <strong><code>hp</code></strong>=<em><code>[]</code></em>, <strong><code>cuda</code></strong>=<em><code>[]</code></em>, <strong><code>callbacks</code></strong>=<em><code>[&lt;function train_callbacks at 0x109855680&gt;]</code></em>) :: <a href="/forgebox/loopstack#LoopStack"><code>LoopStack</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EvalLoop" class="doc_header"><code>class</code> <code>EvalLoop</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L112" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EvalLoop</code>(<strong><code>data_iter</code></strong>) :: <a href="/forgebox/loopstack#LoopStack"><code>LoopStack</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span> <span class="o">=</span> <span class="n">TrainLoop</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">loop</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LoopStack&gt;:TrainLoop
	layer🍰Loop
	layer🍰ProgressBar
	layer🍰Tolerate
	event🌏DATA_PROCESS
	event🌏FORWARD
	event🌏LOSS_CALC
	event🌏BACKWARD
	event🌏OPT_STEP
	event🌏METRICS</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loop layer TrainLoop summary:
==================================================
🍰layer0.0	layer🍰Loop
--------------------------------------------------
🍰layer1.0	layer🍰ProgressBar
	[🐍func_name]	pgbar_data
	[⛰doc]	
        update progress bar with python dictionary
        data: python dictionary
        
	[😝var]	self,data
	[😜names]	t,set_postfix
	...................................
	[🐍func_name]	pgbar_description
	[⛰doc]	
        update progress bar prefix with text string
        
	[😝var]	self,text
	[😜names]	t,set_description_str
	...................................
--------------------------------------------------
🍰layer2.0	layer🍰Tolerate
	[🐍func_name]	error_list
	[⛰doc]	
        A list of errors happend so far
        
	[😝var]	self
	[😜names]	errors
	...................................
--------------------------------------------------
🍰layer3.0	event🌏DATA_PROCESS
	[🐍func_name]	after_last_DATA_PROCESS
	[⛰doc]	
            Append new after_last callback for event:DATA_PROCESS
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	before_1st_DATA_PROCESS
	[⛰doc]	
            Append new before_1st callback for event:DATA_PROCESS
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	on_DATA_PROCESS
	[⛰doc]	
            Append new on callback for event:DATA_PROCESS
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
--------------------------------------------------
🍰layer4.0	event🌏FORWARD
	[🐍func_name]	after_last_FORWARD
	[⛰doc]	
            Append new after_last callback for event:FORWARD
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	before_1st_FORWARD
	[⛰doc]	
            Append new before_1st callback for event:FORWARD
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	on_FORWARD
	[⛰doc]	
            Append new on callback for event:FORWARD
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
--------------------------------------------------
🍰layer5.0	event🌏LOSS_CALC
	[🐍func_name]	after_last_LOSS_CALC
	[⛰doc]	
            Append new after_last callback for event:LOSS_CALC
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	before_1st_LOSS_CALC
	[⛰doc]	
            Append new before_1st callback for event:LOSS_CALC
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	on_LOSS_CALC
	[⛰doc]	
            Append new on callback for event:LOSS_CALC
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
--------------------------------------------------
🍰layer6.0	event🌏BACKWARD
	[🐍func_name]	after_last_BACKWARD
	[⛰doc]	
            Append new after_last callback for event:BACKWARD
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	before_1st_BACKWARD
	[⛰doc]	
            Append new before_1st callback for event:BACKWARD
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	on_BACKWARD
	[⛰doc]	
            Append new on callback for event:BACKWARD
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
--------------------------------------------------
🍰layer7.0	event🌏OPT_STEP
	[🐍func_name]	after_last_OPT_STEP
	[⛰doc]	
            Append new after_last callback for event:OPT_STEP
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	before_1st_OPT_STEP
	[⛰doc]	
            Append new before_1st callback for event:OPT_STEP
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	on_OPT_STEP
	[⛰doc]	
            Append new on callback for event:OPT_STEP
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
--------------------------------------------------
🍰layer8.0	event🌏METRICS
	[🐍func_name]	after_last_METRICS
	[⛰doc]	
            Append new after_last callback for event:METRICS
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	before_1st_METRICS
	[⛰doc]	
            Append new before_1st callback for event:METRICS
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
	[🐍func_name]	on_METRICS
	[⛰doc]	
            Append new on callback for event:METRICS
            Use this function as decorator
        
	[😝var]	cls,f
	[😜names]	getattr
	...................................
--------------------------------------------------
🍰layer9.0	LoopStack&gt;:TrainLoop
	layer🍰Loop
	layer🍰ProgressBar
	layer🍰Tolerate
	event🌏DATA_PROCESS
	event🌏FORWARD
	event🌏LOSS_CALC
	event🌏BACKWARD
	event🌏OPT_STEP
	event🌏METRICS
--------------------------------------------------
==================================================

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;baseline&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@loop</span><span class="o">.</span><span class="n">on_DATA_PROCESS</span>
<span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span>
    <span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">double</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">element</span><span class="o">*</span><span class="mi">2</span>
    
<span class="nd">@loop</span><span class="o">.</span><span class="n">on_FORWARD</span>
<span class="k">def</span> <span class="nf">update_pg</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">pgbar_description</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;double: </span><span class="si">{loop.double}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="nd">@loop</span><span class="o">.</span><span class="n">on_FORWARD</span>
<span class="k">def</span> <span class="nf">another_thing_on_forward</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">pgbar_data</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
WARNING:51 errors
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

