---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/15_loopstack.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="15-LoopStack">15 LoopStack<a class="anchor-link" href="#15-LoopStack">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To run through iterations quickly, we use the california housing data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets.california_housing</span> <span class="kn">import</span> <span class="n">fetch_california_housing</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">fetch_california_housing</span><span class="p">(</span><span class="n">return_X_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((20640, 8), (20640,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Normalized Data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Preview x input</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">denorm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="n">m</span>

<span class="n">x_normed</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_normed</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">())(</span><span class="n">y</span><span class="p">)</span>

<span class="n">x_normed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x_normed</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y_normed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y_normed</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_normed</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span><span class="n">x_normed</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>\
<span class="n">y_normed</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span><span class="n">y_normed</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([-0.04333 ,  0.000478, -0.0397  , -0.04486 , -0.0554  , -0.01229 ,
        -0.007812,  0.001071], dtype=float16),
 array([0.85610596, 0.99901853, 0.53787672, 0.32598025, 0.73420682,
        0.09438235, 0.98221114, 0.99421595]),
 -0.0302,
 0.928904447452199)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_normed</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x1a163d48d0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_normed</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 2.        ,  0.98214266,  0.62855945, ..., -0.04959654,
         1.05254828, -1.32783522],
       [ 2.        , -0.60701891,  0.32704136, ..., -0.09251223,
         1.04318455, -1.32284391],
       [ 1.7826994 ,  1.85618152,  1.15562047, ..., -0.02584253,
         1.03850269, -1.33282653],
       ...,
       [-1.14259331, -0.92485123, -0.09031802, ..., -0.0717345 ,
         1.77823747, -0.8237132 ],
       [-1.05458292, -0.84539315, -0.04021111, ..., -0.09122515,
         1.77823747, -0.87362627],
       [-0.78012947, -1.00430931, -0.07044252, ..., -0.04368215,
         1.75014627, -0.83369581]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_event" class="doc_header"><code>create_event</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_event</code>(<strong><code>event_name</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="events" class="doc_header"><code>events</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>events</code>(<strong>*<code>enames</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LoopStack" class="doc_header"><code>class</code> <code>LoopStack</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L24" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LoopStack</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>) :: <a href="/forgebox/loop#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRAIN_EVENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DATA_PROCESS&quot;</span><span class="p">,</span><span class="s2">&quot;FORWARD&quot;</span><span class="p">,</span><span class="s2">&quot;LOSS_CALC&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BACKWARD&quot;</span><span class="p">,</span><span class="s2">&quot;OPT_STEP&quot;</span><span class="p">,</span><span class="s2">&quot;METRICS&quot;</span><span class="p">]</span>
<span class="n">EVAL_EVENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DATA_PROCESS&quot;</span><span class="p">,</span><span class="s2">&quot;EVAL_WRAP&quot;</span><span class="p">,</span><span class="s2">&quot;FORWARD&quot;</span><span class="p">,</span><span class="s2">&quot;LOSS_CALC&quot;</span><span class="p">,</span><span class="s2">&quot;METRICS&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tabulated-Metrics">Tabulated Metrics<a class="anchor-link" href="#Tabulated-Metrics">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MetricTab</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_by_epoch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_by_epoch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_list</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">row</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The summary on metrics&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_by_epoch</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">batch</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">result_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">batch_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">refresh_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">calc_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">result_df</span><span class="p">,</span><span class="n">batch_df</span><span class="p">):</span>
        <span class="n">product_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">col</span><span class="p">,</span><span class="n">result_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">batch_df</span><span class="p">[</span><span class="s2">&quot;bs&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_cols</span><span class="p">))</span>
        <span class="n">batch_mean</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_cols</span><span class="p">:</span>
            <span class="n">batch_mean</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">product_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">batch_df</span><span class="p">[</span><span class="s2">&quot;bs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">batch_mean</span><span class="p">[</span><span class="s2">&quot;epoch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_by_epoch</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">batch_mean</span><span class="p">[</span><span class="s2">&quot;span&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch_df</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">batch_df</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">batch_mean</span>
    
    <span class="k">def</span> <span class="nf">mark</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_df</span><span class="p">()</span>
        <span class="n">batch_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_df</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">result_cols</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_cols</span><span class="p">:</span>
            <span class="n">batch_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            
        <span class="n">batch_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_mean</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span><span class="n">batch_df</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">df_by_epoch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_by_epoch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_mean</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_list</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">batch_df</span><span class="p">,</span> <span class="n">batch_mean</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metab</span> <span class="o">=</span> <span class="n">MetricTab</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">01</span><span class="p">)</span>
    <span class="n">metab</span><span class="o">+=</span><span class="nb">dict</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">i</span><span class="p">))</span>
    <span class="n">metab</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">epoch</span><span class="o">=</span><span class="n">i</span><span class="o">//</span><span class="mi">5</span><span class="p">,</span><span class="n">bs</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span><span class="n">ts</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_df</span><span class="p">,</span><span class="n">batch_mean</span> <span class="o">=</span> <span class="n">metab</span><span class="o">.</span><span class="n">mark</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">batch_df</span><span class="p">)</span>
<span class="n">batch_mean</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>i</th>
      <th>epoch</th>
      <th>bs</th>
      <th>ts</th>
      <th>loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>2020-06-27 00:13:58.336637</td>
      <td>77.890621</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>32</td>
      <td>2020-06-27 00:13:58.348200</td>
      <td>74.198538</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>32</td>
      <td>2020-06-27 00:13:58.358385</td>
      <td>16.766426</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>32</td>
      <td>2020-06-27 00:13:58.369278</td>
      <td>45.024939</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>32</td>
      <td>2020-06-27 00:13:58.381860</td>
      <td>34.455464</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>95</td>
      <td>19</td>
      <td>32</td>
      <td>2020-06-27 00:13:59.442931</td>
      <td>4.624593</td>
    </tr>
    <tr>
      <th>96</th>
      <td>96</td>
      <td>19</td>
      <td>32</td>
      <td>2020-06-27 00:13:59.453216</td>
      <td>2.810572</td>
    </tr>
    <tr>
      <th>97</th>
      <td>97</td>
      <td>19</td>
      <td>32</td>
      <td>2020-06-27 00:13:59.465926</td>
      <td>2.588210</td>
    </tr>
    <tr>
      <th>98</th>
      <td>98</td>
      <td>19</td>
      <td>32</td>
      <td>2020-06-27 00:13:59.478903</td>
      <td>0.560318</td>
    </tr>
    <tr>
      <th>99</th>
      <td>99</td>
      <td>19</td>
      <td>32</td>
      <td>2020-06-27 00:13:59.491660</td>
      <td>0.308851</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 26.498444349723876,
 &#39;epoch&#39;: 1,
 &#39;span&#39;: Timedelta(&#39;0 days 00:00:01.155023&#39;)}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metab</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loss</th>
      <th>epoch</th>
      <th>span</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26.498444</td>
      <td>1</td>
      <td>00:00:01.155023</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_callbacks" class="doc_header"><code>train_callbacks</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_callbacks</code>(<strong><code>loop</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="eval_callbacks" class="doc_header"><code>eval_callbacks</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>eval_callbacks</code>(<strong><code>loop</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_tensor" class="doc_header"><code>to_tensor</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L79" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_tensor</code>(<strong><code>x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="simple_forward" class="doc_header"><code>simple_forward</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>simple_forward</code>(<strong><code>metric_func</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="single_device" class="doc_header"><code>single_device</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>single_device</code>(<strong><code>device</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TrainLoop" class="doc_header"><code>class</code> <code>TrainLoop</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L154" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TrainLoop</code>(<strong><code>data_iter</code></strong>, <strong><code>model</code></strong>=<em><code>[]</code></em>, <strong><code>opt</code></strong>=<em><code>[]</code></em>, <strong><code>loss_func</code></strong>=<em><code>[]</code></em>, <strong><code>loss</code></strong>=<em><code>[]</code></em>, <strong><code>hp</code></strong>=<em><code>[]</code></em>, <strong><code>cuda</code></strong>=<em><code>[]</code></em>, <strong><code>callbacks</code></strong>=<em><code>[&lt;function train_callbacks at 0x105a3f440&gt;]</code></em>, <strong><code>tolerate</code></strong>=<em><code>True</code></em>) :: <a href="/forgebox/loopstack#LoopStack"><code>LoopStack</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EvalLoop" class="doc_header"><code>class</code> <code>EvalLoop</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L170" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EvalLoop</code>(<strong><code>data_iter</code></strong>, <strong><code>tolerate</code></strong>=<em><code>True</code></em>) :: <a href="/forgebox/loopstack#LoopStack"><code>LoopStack</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">data_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">chunkify</span><span class="p">(</span><span class="n">x_normed</span><span class="p">),</span><span class="n">chunkify</span><span class="p">(</span><span class="n">y_normed</span><span class="p">)))</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">TrainLoop</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span><span class="n">tolerate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">train_callbacks</span><span class="p">,</span>
                            <span class="n">simple_forward</span><span class="p">([</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()])])</span>
<span class="n">loop</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>assigning callback &lt;function train_callbacks at 0x1a2d7c99e0&gt;
assigning callback &lt;function simple_forward.&lt;locals&gt;.simple_forward_cb at 0x1a2d7e2b00&gt;
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LoopStack&gt;:TrainLoop
	layer🍰Loop
	layer🍰ProgressBar
	event🌏DATA_PROCESS
	event🌏FORWARD
	event🌏LOSS_CALC
	event🌏BACKWARD
	event🌏OPT_STEP
	event🌏METRICS</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># loop.search()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loop</span><span class="o">.</span><span class="n">loss_func</span><span class="o">.</span><span class="n">mse</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">loop</span><span class="o">.</span><span class="n">metric_func</span><span class="o">.</span><span class="n">mae</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
<span class="n">loop</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">adam</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">loop</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mae</th>
      <th>mse</th>
      <th>epoch</th>
      <th>span</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.793236</td>
      <td>0.980813</td>
      <td>1</td>
      <td>00:00:02.143544</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.614251</td>
      <td>0.597763</td>
      <td>2</td>
      <td>00:00:02.204130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.532322</td>
      <td>0.461204</td>
      <td>3</td>
      <td>00:00:02.131806</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.492559</td>
      <td>0.406819</td>
      <td>4</td>
      <td>00:00:02.016984</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.469879</td>
      <td>0.377455</td>
      <td>5</td>
      <td>00:00:02.194623</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.453884</td>
      <td>0.356890</td>
      <td>6</td>
      <td>00:00:02.049320</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.441853</td>
      <td>0.341606</td>
      <td>7</td>
      <td>00:00:02.064624</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.432821</td>
      <td>0.330527</td>
      <td>8</td>
      <td>00:00:02.060480</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.426311</td>
      <td>0.322731</td>
      <td>9</td>
      <td>00:00:02.138526</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.421742</td>
      <td>0.317332</td>
      <td>10</td>
      <td>00:00:02.595590</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">metric_df</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">metric_tab</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">metric_df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metric_df</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span><span class="s2">&quot;g--&quot;</span><span class="p">,</span><span class="n">metric_df</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span><span class="s2">&quot;b.&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mae</th>
      <th>mse</th>
      <th>epoch</th>
      <th>span</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.793236</td>
      <td>0.980813</td>
      <td>1</td>
      <td>00:00:02.143544</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.614251</td>
      <td>0.597763</td>
      <td>2</td>
      <td>00:00:02.204130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.532322</td>
      <td>0.461204</td>
      <td>3</td>
      <td>00:00:02.131806</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.492559</td>
      <td>0.406819</td>
      <td>4</td>
      <td>00:00:02.016984</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.469879</td>
      <td>0.377455</td>
      <td>5</td>
      <td>00:00:02.194623</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.453884</td>
      <td>0.356890</td>
      <td>6</td>
      <td>00:00:02.049320</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.441853</td>
      <td>0.341606</td>
      <td>7</td>
      <td>00:00:02.064624</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.432821</td>
      <td>0.330527</td>
      <td>8</td>
      <td>00:00:02.060480</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.426311</td>
      <td>0.322731</td>
      <td>9</td>
      <td>00:00:02.138526</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.421742</td>
      <td>0.317332</td>
      <td>10</td>
      <td>00:00:02.595590</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x1a2d8e6ed0&gt;,
 &lt;matplotlib.lines.Line2D at 0x1a2d8ef190&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>🍄:model[
	baseline
]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">loss_func</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>🍄:loss_func[
	mse
]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">metric</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>🍄:metric[
	mae
	mse
]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">mse</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.1213, grad_fn=&lt;MseLossBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

