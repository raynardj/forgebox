---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/15_loopstack.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="15-LoopStack">15 LoopStack<a class="anchor-link" href="#15-LoopStack">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets.california_housing</span> <span class="k">import</span> <span class="n">fetch_california_housing</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">fetch_california_housing</span><span class="p">(</span><span class="n">return_X_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((20640, 8), (20640,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Normalized Data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">denorm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="n">m</span>

<span class="n">x_normed</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_normed</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">())(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_normed</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span><span class="n">x_normed</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>\
<span class="n">y_normed</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">),</span><span class="n">y_normed</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([ 0.,  0.,  0., -0., -0.,  0., -0., -0.], dtype=float16),
 array([1., 1., 1., 1., 1., 1., 1., 1.]),
 0.0,
 1.0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Preview x input</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_normed</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x1a1949c6d0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_event" class="doc_header"><code>create_event</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_event</code>(<strong><code>event_name</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="events" class="doc_header"><code>events</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>events</code>(<strong>*<code>enames</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LoopStack" class="doc_header"><code>class</code> <code>LoopStack</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LoopStack</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>) :: <a href="/forgebox/loop#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRAIN_EVENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DATA_PROCESS&quot;</span><span class="p">,</span><span class="s2">&quot;FORWARD&quot;</span><span class="p">,</span><span class="s2">&quot;LOSS_CALC&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BACKWARD&quot;</span><span class="p">,</span><span class="s2">&quot;OPT_STEP&quot;</span><span class="p">,</span><span class="s2">&quot;METRICS&quot;</span><span class="p">]</span>
<span class="n">EVAL_EVENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DATA_PROCESS&quot;</span><span class="p">,</span><span class="s2">&quot;EVAL_WRAP&quot;</span><span class="p">,</span><span class="s2">&quot;FORWARD&quot;</span><span class="p">,</span><span class="s2">&quot;LOSS_CALC&quot;</span><span class="p">,</span><span class="s2">&quot;METRICS&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TrainLoop" class="doc_header"><code>class</code> <code>TrainLoop</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L57" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TrainLoop</code>(<strong><code>data_iter</code></strong>) :: <a href="/forgebox/loopstack#LoopStack"><code>LoopStack</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EvalLoop" class="doc_header"><code>class</code> <code>EvalLoop</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loopstack.py#L72" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EvalLoop</code>(<strong><code>data_iter</code></strong>) :: <a href="/forgebox/loopstack#LoopStack"><code>LoopStack</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span> <span class="o">=</span> <span class="n">TrainLoop</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">loop</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LoopStack&gt;:TrainLoop
	layer🍰Loop
	layer🍰ProgressBar
	layer🍰Tolerate
	event🌏DATA_PROCESS
	event🌏FORWARD
	event🌏LOSS_CALC
	event🌏BACKWARD
	event🌏OPT_STEP
	event🌏METRICS</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;baseline&quot;</span><span class="p">]</span><span class="o">=</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-141-8efba2eecf81&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>loop<span class="ansi-blue-fg">.</span>summary<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/github/forgebox/forgebox/loop.py</span> in <span class="ansi-cyan-fg">summary</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>         <span class="ansi-green-fg">for</span> idx<span class="ansi-blue-fg">,</span>layer <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>core<span class="ansi-blue-fg">.</span>lmap<span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span>             rt<span class="ansi-blue-fg">+=</span> <span class="ansi-blue-fg">f&#34;🍰layer{idx}\t{str(layer)}\n&#34;</span>
<span class="ansi-green-fg">--&gt; 146</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">for</span> fname<span class="ansi-blue-fg">,</span>f <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>core<span class="ansi-blue-fg">.</span>for_all_functions<span class="ansi-blue-fg">(</span>layer<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    147</span>                 <span class="ansi-green-fg">if</span> id<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">in</span> funcs<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    148</span>                     rt<span class="ansi-blue-fg">+=</span><span class="ansi-blue-fg">&#34;\t&#34;</span>

<span class="ansi-green-fg">~/github/forgebox/forgebox/loop.py</span> in <span class="ansi-cyan-fg">for_all_functions</span><span class="ansi-blue-fg">(self, obj)</span>
<span class="ansi-green-intense-fg ansi-bold">     94</span>     <span class="ansi-green-fg">def</span> for_all_functions<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>obj<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     95</span>         return dict(inspect.getmembers(obj,
<span class="ansi-green-fg">---&gt; 96</span><span class="ansi-red-fg">                   predicate=lambda x:hasattr(x,&#34;forall&#34;)))
</span><span class="ansi-green-intense-fg ansi-bold">     97</span> 
<span class="ansi-green-intense-fg ansi-bold">     98</span>     <span class="ansi-green-fg">def</span> update_forall<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>obj<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/inspect.py</span> in <span class="ansi-cyan-fg">getmembers</span><span class="ansi-blue-fg">(object, predicate)</span>
<span class="ansi-green-intense-fg ansi-bold">    352</span>                 <span class="ansi-red-fg"># __dir__; discard and move on</span>
<span class="ansi-green-intense-fg ansi-bold">    353</span>                 <span class="ansi-green-fg">continue</span>
<span class="ansi-green-fg">--&gt; 354</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> predicate <span class="ansi-green-fg">or</span> predicate<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    355</span>             results<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    356</span>         processed<span class="ansi-blue-fg">.</span>add<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/github/forgebox/forgebox/loop.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-fg">(x)</span>
<span class="ansi-green-intense-fg ansi-bold">     94</span>     <span class="ansi-green-fg">def</span> for_all_functions<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>obj<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     95</span>         return dict(inspect.getmembers(obj,
<span class="ansi-green-fg">---&gt; 96</span><span class="ansi-red-fg">                   predicate=lambda x:hasattr(x,&#34;forall&#34;)))
</span><span class="ansi-green-intense-fg ansi-bold">     97</span> 
<span class="ansi-green-intense-fg ansi-bold">     98</span>     <span class="ansi-green-fg">def</span> update_forall<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>obj<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/github/forgebox/forgebox/loop.py</span> in <span class="ansi-cyan-fg">__getattr__</span><span class="ansi-blue-fg">(self, k)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>funcs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     31</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 32</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> KeyError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#34;❌🗝no key [{k}]: in self.cases or self.funcs&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span> 
<span class="ansi-green-intense-fg ansi-bold">     34</span>     <span class="ansi-green-fg">def</span> __repr__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyError</span>: &#39;❌🗝no key [forall]: in self.cases or self.funcs&#39;</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@loop</span><span class="o">.</span><span class="n">on_DATA_PROCESS</span>
<span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span>
    <span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">double</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">element</span><span class="o">*</span><span class="mi">2</span>
    
<span class="nd">@loop</span><span class="o">.</span><span class="n">on_FORWARD</span>
<span class="k">def</span> <span class="nf">update_pg</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">pgbar_description</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;double: </span><span class="si">{loop.double}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="nd">@loop</span><span class="o">.</span><span class="n">on_FORWARD</span>
<span class="k">def</span> <span class="nf">another_thing_on_forward</span><span class="p">(</span><span class="n">loop</span><span class="p">):</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">pgbar_data</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
WARNING:51 errors
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loop</span><span class="o">.</span><span class="n">error_list</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;stage&#39;: &#39;start_cb&#39;,
  &#39;i&#39;: -1,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;model&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 0,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 1,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 2,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 3,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 4,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 5,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 6,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 7,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 8,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 9,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 10,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 11,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 12,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 13,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 14,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 15,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 16,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 17,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 18,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 19,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 20,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 21,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 22,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 23,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 24,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 25,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 26,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 27,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 28,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 29,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 30,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 31,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 32,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 33,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 34,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 35,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 36,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 37,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 38,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 39,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 40,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 41,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 42,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 43,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 44,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 45,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 46,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 47,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 48,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)},
 {&#39;stage&#39;: &#39;iter_cb&#39;,
  &#39;i&#39;: 49,
  &#39;epoch&#39;: 0,
  &#39;error&#39;: AttributeError(&#34;&#39;StorageCore&#39; object has no attribute &#39;opt&#39;&#34;)}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

