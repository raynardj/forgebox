---

title: Controllable loop process

keywords: fastai
sidebar: home_sidebar

summary: "iteration with callbacks"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/10_loop.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="method4all" class="doc_header"><code>method4all</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>method4all</code>(<strong><code>f</code></strong>)</p>
</blockquote>
<p>Use this function as a decorator,
The decorated function under Loop class can be used on outer layer</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="StorageCore" class="doc_header"><code>class</code> <code>StorageCore</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L22" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>StorageCore</code>(<strong><code>start_layer</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Loop" class="doc_header"><code>class</code> <code>Loop</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L56" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Loop</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loop-in-loop-concept">Loop-in-loop concept<a class="anchor-link" href="#Loop-in-loop-concept">&#182;</a></h2><p>Loop and its inheriting descendants runs on iterable, incuding other <code>[`Loop`](/forgebox/loop#Loop)</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="n">Loop</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;hahahha&quot;</span><span class="p">)</span>
<span class="n">l</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>layer:&gt;&gt;&gt;hahahha</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Printer</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;i_</span><span class="si">{self.core.i}</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">element</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">start_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;start of epoch </span><span class="si">{self.epoch}</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">end_call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;end of epoch </span><span class="si">{self.epoch}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">l2</span> <span class="o">=</span> <span class="n">Printer</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start of epoch 0
i_0	5
i_1	6
i_2	7
i_3	8
i_4	9
end of epoch 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Progress-bar">Progress bar<a class="anchor-link" href="#Progress-bar">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ProgressBar" class="doc_header"><code>class</code> <code>ProgressBar</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L245" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ProgressBar</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>, <strong><code>jupyter</code></strong>=<em><code>True</code></em>, <strong><code>mininterval</code></strong>=<em><code>0.1</code></em>) :: <a href="/forgebox/loop#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="k">import</span> <span class="n">tqdm</span><span class="p">,</span><span class="n">tqdm_notebook</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pb</span> <span class="o">=</span> <span class="n">ProgressBar</span><span class="p">(</span><span class="n">Loop</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)),</span><span class="n">jupyter</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Downstream-wraper">Downstream wraper<a class="anchor-link" href="#Downstream-wraper">&#182;</a></h3><blockquote><p>A unique way to contain downstream task in a function, hence a good Error Handling mechanism</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In cases you don't want error stop the iteration, meanwhile taking down all the error message.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="error_tolerate" class="doc_header"><code>error_tolerate</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L288" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>error_tolerate</code>(<strong><code>downstream_func</code></strong>)</p>
</blockquote>
<p>downstream_func:Downstream function</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Tolerate" class="doc_header"><code>class</code> <code>Tolerate</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L300" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Tolerate</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>) :: <a href="/forgebox/loop#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Tolerate any error happened downstream
layer2 = Tolerate(upstream_iterable)</p>
<h1 id="build-downstream-tasks">build downstream tasks<a class="anchor-link" href="#build-downstream-tasks">&#182;</a></h1><p>layer3 = OtherApplication(layer2)
layer3.run()</p>
<h1 id="show-the-happened-error-message">show the happened error message<a class="anchor-link" href="#show-the-happened-error-message">&#182;</a></h1><p>layer3.error_list()</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LambdaCall" class="doc_header"><code>class</code> <code>LambdaCall</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L326" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LambdaCall</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>, <strong><code>func</code></strong>=<em><code>'&lt;lambda&gt;'</code></em>, <strong><code>start_func</code></strong>=<em><code>'&lt;lambda&gt;'</code></em>, <strong><code>end_func</code></strong>=<em><code>'&lt;lambda&gt;'</code></em>) :: <a href="/forgebox/loop#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Basic loop class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="n">ProgressBar</span><span class="p">(</span><span class="n">Loop</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="n">error_loop</span> <span class="o">=</span> <span class="n">LambdaCall</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">func</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="mi">5</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">element</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Running this will yield error</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">error_loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">error_on_purpose</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">element</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;value too small, </span><span class="si">{x.element}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">l1</span> <span class="o">=</span> <span class="n">ProgressBar</span><span class="p">(</span><span class="n">Loop</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="c1"># add the tolerate layer in between</span>
<span class="n">l2</span> <span class="o">=</span> <span class="n">Tolerate</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<span class="c1"># tolerate can only tolerate the erorr on downstream</span>
<span class="n">tolerated_loop</span> <span class="o">=</span> <span class="n">LambdaCall</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span><span class="n">func</span><span class="o">=</span><span class="n">error_on_purpose</span><span class="p">,</span><span class="n">end_func</span><span class="o">=</span><span class="n">error_on_purpose</span><span class="p">)</span>
<span class="n">l2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>you can use <code>error_list</code> function to print all the happened error</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">l2</span><span class="o">.</span><span class="n">error_list</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stage</th>
      <th>i</th>
      <th>epoch</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>start_cb</td>
      <td>-1</td>
      <td>0</td>
      <td>'StorageCore' object has no attribute 'element'</td>
    </tr>
    <tr>
      <td>1</td>
      <td>iter_cb</td>
      <td>5</td>
      <td>0</td>
      <td>value too small, 6</td>
    </tr>
    <tr>
      <td>2</td>
      <td>iter_cb</td>
      <td>6</td>
      <td>0</td>
      <td>value too small, 7</td>
    </tr>
    <tr>
      <td>3</td>
      <td>iter_cb</td>
      <td>7</td>
      <td>0</td>
      <td>value too small, 8</td>
    </tr>
    <tr>
      <td>4</td>
      <td>iter_cb</td>
      <td>8</td>
      <td>0</td>
      <td>value too small, 9</td>
    </tr>
    <tr>
      <td>5</td>
      <td>end_cb</td>
      <td>8</td>
      <td>0</td>
      <td>value too small, 9</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loop layer Tolerate summary:
==================================================
ğŸ°layer0.0	layer:&gt;&gt;&gt;Loop
--------------------------------------------------
ğŸ°layer1.0	layer:&gt;&gt;&gt;ProgressBar
	[ğŸfunc_name]	pgbar_data
	[â›°doc]	
        update progress bar with python dictionary
        data: python dictionary
        
	[ğŸ˜var]	self,data
	[ğŸ˜œnames]	t,set_postfix
	...................................
	[ğŸfunc_name]	pgbar_description
	[â›°doc]	
        update progress bar prefix with text string
        
	[ğŸ˜var]	self,text
	[ğŸ˜œnames]	t,set_description_str
	...................................
--------------------------------------------------
ğŸ°layer2.0	layer:&gt;&gt;&gt;Tolerate
	[ğŸfunc_name]	error_list
	[â›°doc]	
        A list of errors happend so far
        
	[ğŸ˜var]	self
	[ğŸ˜œnames]	errors
	...................................
--------------------------------------------------
ğŸ°layer3.0	layer:&gt;&gt;&gt;Lambda&lt;0x121ee34d0&gt;
--------------------------------------------------
==================================================

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Application-upon-progress-bar">Application upon progress bar<a class="anchor-link" href="#Application-upon-progress-bar">&#182;</a></h3><p>The function <code>pgbar_data</code> is decorated under <code>[`method4all`](/forgebox/loop#method4all)</code>, hence the function can be used else where</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="k">class</span> <span class="nc">Application</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># create some data</span>
        <span class="n">loop_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">epoch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">epoch</span><span class="p">,</span><span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">,</span>
                         <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,)</span>
        <span class="c1"># update data to progress bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pgbar_data</span><span class="p">(</span><span class="n">loop_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pgbar_description</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)))</span>

<span class="n">l3</span> <span class="o">=</span> <span class="n">Application</span><span class="p">(</span><span class="n">ProgressBar</span><span class="p">(</span><span class="n">Loop</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)),</span><span class="n">jupyter</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">l3</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Print-out-the-summary-of-the-loop">Print out the summary of the loop<a class="anchor-link" href="#Print-out-the-summary-of-the-loop">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loop layer Application summary:
==================================================
ğŸ°layer0.0	layer:&gt;&gt;&gt;Loop
--------------------------------------------------
ğŸ°layer1.0	layer:&gt;&gt;&gt;ProgressBar
	[ğŸfunc_name]	pgbar_data
	[â›°doc]	
        update progress bar with python dictionary
        data: python dictionary
        
	[ğŸ˜var]	self,data
	[ğŸ˜œnames]	t,set_postfix
	...................................
	[ğŸfunc_name]	pgbar_description
	[â›°doc]	
        update progress bar prefix with text string
        
	[ğŸ˜var]	self,text
	[ğŸ˜œnames]	t,set_description_str
	...................................
--------------------------------------------------
ğŸ°layer2.0	layer:&gt;&gt;&gt;Application
--------------------------------------------------
==================================================

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l3</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Event">Event<a class="anchor-link" href="#Event">&#182;</a></h2><p>Event allows add-hoc callbacks to be created</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Event" class="doc_header"><code>class</code> <code>Event</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/loop.py#L348" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Event</code>(<strong><code>iterable</code></strong>=<em><code>[]</code></em>) :: <a href="/forgebox/loop#Loop"><code>Loop</code></a></p>
</blockquote>
<p>An event is the landmark with in 1 iteration</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ToString</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;variable_</span><span class="si">{self.i}</span><span class="s2">&quot;</span>

<span class="k">class</span> <span class="nc">ChangeString</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">iterable</span><span class="o">=</span><span class="p">[]):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">iterable</span><span class="o">=</span><span class="n">iterable</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_frame</span><span class="p">(</span><span class="n">li</span><span class="p">):</span>
    <span class="n">layer1</span> <span class="o">=</span> <span class="n">ProgressBar</span><span class="p">(</span><span class="n">Loop</span><span class="p">(</span><span class="n">li</span><span class="p">,</span><span class="s2">&quot;base&quot;</span><span class="p">))</span>
    <span class="n">layer2</span> <span class="o">=</span> <span class="n">ToString</span><span class="p">(</span><span class="n">layer1</span><span class="p">,)</span>
    <span class="n">layer3</span> <span class="o">=</span> <span class="n">ChangeString</span><span class="p">(</span><span class="n">layer2</span><span class="p">)</span>
    <span class="c1"># you can use this &quot;on&quot; syntax</span>
    <span class="nd">@layer3</span><span class="o">.</span><span class="n">ChangeString</span><span class="o">.</span><span class="n">on</span>
    <span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;Var_</span><span class="si">{self.element}</span><span class="s2">&quot;</span>
        
    <span class="c1"># or this syntax</span>
    <span class="nd">@layer3</span><span class="o">.</span><span class="n">on_ChangeString</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pgbar_description</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">)</span>
        
    <span class="nd">@layer3</span><span class="o">.</span><span class="n">before_1st_ChangeString</span>
    <span class="k">def</span> <span class="nf">print_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        decorated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;start_</span><span class="si">{self.epoch}</span><span class="s2">_</span><span class="si">{self.i}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">layer3</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="n">get_frame</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span><span class="o">.</span><span class="n">core</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{0.0: layer:&gt;&gt;&gt;base, 1.0: layer:&gt;&gt;&gt;ProgressBar, 2.0: layer:&gt;&gt;&gt;ToString, 3.0: layer:&gt;&gt;&gt;ChangeString}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span><span class="o">.</span><span class="n">cbs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[layer:&gt;&gt;&gt;ON_ChangeString_1_trim,
 layer:&gt;&gt;&gt;ON_ChangeString_2_update,
 layer:&gt;&gt;&gt;BEFORE_1ST_ChangeString_3_print_start]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loop layer ChangeString summary:
==================================================
ğŸ°layer0.0	layer:&gt;&gt;&gt;base
--------------------------------------------------
ğŸ°layer1.0	layer:&gt;&gt;&gt;ProgressBar
	[ğŸfunc_name]	pgbar_data
	[â›°doc]	
        update progress bar with python dictionary
        data: python dictionary
        
	[ğŸ˜var]	self,data
	[ğŸ˜œnames]	t,set_postfix
	...................................
	[ğŸfunc_name]	pgbar_description
	[â›°doc]	
        update progress bar prefix with text string
        
	[ğŸ˜var]	self,text
	[ğŸ˜œnames]	t,set_description_str
	...................................
--------------------------------------------------
ğŸ°layer2.0	layer:&gt;&gt;&gt;ToString
--------------------------------------------------
ğŸ°layer3.0	layer:&gt;&gt;&gt;ChangeString
	[ğŸfunc_name]	after_last_ChangeString
	[â›°doc]	
            Append new after_last callback for event:ChangeString
            Use this function as decorator
        
	[ğŸ˜var]	cls,f
	[ğŸ˜œnames]	getattr
	...................................
	[ğŸfunc_name]	before_1st_ChangeString
	[â›°doc]	
            Append new before_1st callback for event:ChangeString
            Use this function as decorator
        
	[ğŸ˜var]	cls,f
	[ğŸ˜œnames]	getattr
	...................................
	[ğŸfunc_name]	on_ChangeString
	[â›°doc]	
            Append new on callback for event:ChangeString
            Use this function as decorator
        
	[ğŸ˜var]	cls,f
	[ğŸ˜œnames]	getattr
	...................................
--------------------------------------------------
==================================================

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span><span class="o">.</span><span class="n">layers</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[layer:&gt;&gt;&gt;base, layer:&gt;&gt;&gt;ProgressBar, layer:&gt;&gt;&gt;ToString, layer:&gt;&gt;&gt;ChangeString]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start_0_-1
ChangeString

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">layer</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="k">while</span> <span class="n">layer</span><span class="o">.</span><span class="n">next_layer</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
    <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">next_layer</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">start_call</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>layer:&gt;&gt;&gt;base
None
None
None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

