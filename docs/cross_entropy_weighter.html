---

title: Create multi-task adjustment for cross-entropy

keywords: fastai
sidebar: home_sidebar

summary: "A weighter for multi-task learning with different softmax+cross-entropy"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/cross_entropy_weighter.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tools-and-imports">Tools and imports<a class="anchor-link" href="#Tools-and-imports">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Enters-softmax">Enters softmax<a class="anchor-link" href="#Enters-softmax">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">softmax</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">crit</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Experience-the-problem">Experience the problem<a class="anchor-link" href="#Experience-the-problem">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_loss</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">iters</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="n">get_xy</span><span class="p">):</span>
    <span class="n">losses</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iters</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">get_xy</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nb_output</span><span class="p">)</span>
            <span class="n">y_vec</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">crit</span><span class="p">(</span><span class="n">y_vec</span><span class="p">,</span><span class="n">y_true</span><span class="p">)</span>
            <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">create_softmax_pipeline</span><span class="p">(</span>
        <span class="n">nb_layers</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">nb_output</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">hs</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">crit</span><span class="p">:</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">(),</span>
    <span class="p">)</span><span class="o">-&gt;</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
    <span class="n">modules</span> <span class="o">=</span> <span class="p">(</span><span class="n">nb_layers</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span><span class="n">hs</span><span class="p">),</span><span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">)]</span>
    <span class="n">modules</span><span class="o">+=</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span><span class="n">nb_output</span><span class="p">),]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">modules</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">hs</span> <span class="o">=</span> <span class="n">hs</span>
    <span class="n">model</span><span class="o">.</span><span class="n">nb_output</span> <span class="o">=</span> <span class="n">nb_output</span>
    <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">crit</span> <span class="o">=</span> <span class="n">crit</span>
    <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">test_loss</span> <span class="o">=</span> <span class="n">test_loss</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">random_input</span><span class="p">(</span><span class="n">nb_output</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="n">nb_output</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>

<span class="k">def</span> <span class="nf">inbalanced_input</span><span class="p">(</span>
        <span class="n">bias</span><span class="p">:</span><span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">inbalanced_input_</span><span class="p">(</span><span class="n">nb_output</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">high</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">nb_output</span><span class="o">*</span><span class="n">bias</span><span class="p">)),</span>
            <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">inbalanced_input_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>For models with different branches of output, some output 2 category, some output more, like 200,500</li>
<li>Their loss will end up in different scale</li>
<li>That makes mixing them up fairly hard and unfair to lesser category tasks</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">create_softmax_pipeline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">test_loss</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="n">inbalanced_input</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">inbl_bias</span><span class="o">=</span><span class="n">b</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>classes</th>
      <th>loss</th>
      <th>inbl_bias</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2244</td>
      <td>7.784015</td>
      <td>0.719190</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2447</td>
      <td>7.849158</td>
      <td>0.002960</td>
    </tr>
    <tr>
      <th>2</th>
      <td>706</td>
      <td>6.625416</td>
      <td>0.297956</td>
    </tr>
    <tr>
      <th>3</th>
      <td>272</td>
      <td>5.739001</td>
      <td>0.154829</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2860</td>
      <td>7.994882</td>
      <td>0.179631</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2376</td>
      <td>7.823036</td>
      <td>0.554090</td>
    </tr>
    <tr>
      <th>6</th>
      <td>474</td>
      <td>6.230643</td>
      <td>0.497769</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1476</td>
      <td>7.317650</td>
      <td>0.790722</td>
    </tr>
    <tr>
      <th>8</th>
      <td>729</td>
      <td>6.652312</td>
      <td>0.671657</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1183</td>
      <td>7.161001</td>
      <td>0.422553</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1792</td>
      <td>7.571034</td>
      <td>0.375524</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2601</td>
      <td>7.928347</td>
      <td>0.937953</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1988</td>
      <td>7.653401</td>
      <td>0.448365</td>
    </tr>
    <tr>
      <th>13</th>
      <td>617</td>
      <td>6.471711</td>
      <td>0.669720</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1257</td>
      <td>7.196665</td>
      <td>0.180724</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1208</td>
      <td>7.142272</td>
      <td>0.603882</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1571</td>
      <td>7.431909</td>
      <td>0.307233</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1815</td>
      <td>7.565763</td>
      <td>0.271957</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2370</td>
      <td>7.840256</td>
      <td>0.130841</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2421</td>
      <td>7.835362</td>
      <td>0.470347</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2608</td>
      <td>7.933852</td>
      <td>0.362477</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1833</td>
      <td>7.566414</td>
      <td>0.551423</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1769</td>
      <td>7.536047</td>
      <td>0.630381</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1950</td>
      <td>7.615793</td>
      <td>0.795910</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1910</td>
      <td>7.585739</td>
      <td>0.343632</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2301</td>
      <td>7.798465</td>
      <td>0.829628</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2377</td>
      <td>7.869211</td>
      <td>0.016988</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1496</td>
      <td>7.393178</td>
      <td>0.119690</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1179</td>
      <td>7.147058</td>
      <td>0.568997</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1475</td>
      <td>7.356740</td>
      <td>0.693435</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2409</td>
      <td>7.835954</td>
      <td>0.455461</td>
    </tr>
    <tr>
      <th>31</th>
      <td>542</td>
      <td>6.328403</td>
      <td>0.733283</td>
    </tr>
    <tr>
      <th>32</th>
      <td>699</td>
      <td>6.609892</td>
      <td>0.674927</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2966</td>
      <td>8.062770</td>
      <td>0.268944</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2831</td>
      <td>8.006001</td>
      <td>0.822981</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1657</td>
      <td>7.459473</td>
      <td>0.323996</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1469</td>
      <td>7.316678</td>
      <td>0.062805</td>
    </tr>
    <tr>
      <th>37</th>
      <td>674</td>
      <td>6.579655</td>
      <td>0.812632</td>
    </tr>
    <tr>
      <th>38</th>
      <td>654</td>
      <td>6.550060</td>
      <td>0.601652</td>
    </tr>
    <tr>
      <th>39</th>
      <td>194</td>
      <td>5.350555</td>
      <td>0.238536</td>
    </tr>
    <tr>
      <th>40</th>
      <td>250</td>
      <td>5.567015</td>
      <td>0.270642</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2368</td>
      <td>7.819131</td>
      <td>0.117133</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1573</td>
      <td>7.429606</td>
      <td>0.003537</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2994</td>
      <td>8.053926</td>
      <td>0.764925</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2155</td>
      <td>7.741345</td>
      <td>0.941843</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2642</td>
      <td>7.919126</td>
      <td>0.612718</td>
    </tr>
    <tr>
      <th>46</th>
      <td>486</td>
      <td>6.242527</td>
      <td>0.701243</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1948</td>
      <td>7.644366</td>
      <td>0.970036</td>
    </tr>
    <tr>
      <th>48</th>
      <td>2626</td>
      <td>7.932363</td>
      <td>0.657842</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1660</td>
      <td>7.466812</td>
      <td>0.855916</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-pattern">The pattern<a class="anchor-link" href="#The-pattern">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are $n$ tasks $T$ with a set of numbers of classes $C$ where $c_{i}$ is the number of the classes of task $T_{i}$</p>
<p>The number of classes $c_{i}$ has certain correlation of the average loss $L_{i}$</p>
<p>Where $log_{10}(c_{i})$ has a clear linear relationship with $L$</p>
<p>$L_{i} = a.log_{10}(c_{i})$, where a is a fixed constant</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">classes</span><span class="p">),</span><span class="n">df</span><span class="o">.</span><span class="n">loss</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x132a9c210&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-solution">The solution<a class="anchor-link" href="#The-solution">&#182;</a></h3><p>Assume we have certain function, will produce a weight that will bring each cross entropy loss to the same constant scale ${a}$.</p>
<p>$L_{i}.f(c_{i})=a$</p>
<p>$f(c_{i})a.log_{10}(c_{i})=a$</p>
<p>Here we can get how to calculate $f(c_{i})$</p>
<p>$f(c_{i})=\frac{1}{log_{10}(c_{i})}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">adjust</span><span class="p">(</span><span class="n">nb_class</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">nb_class</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;lambda_weighted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">adjust</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]),</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For now it's a about the same scale of loss</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">lambda_weighted</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x132a9c150&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Adjusted-CrossEntropy">Adjusted CrossEntropy<a class="anchor-link" href="#Adjusted-CrossEntropy">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiTaskCELoss" class="doc_header"><code>class</code> <code>MultiTaskCELoss</code><a href="https://github.com/raynardj/forgebox/tree/master/forgebox/multitask_ce.py#L13" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiTaskCELoss</code>() :: <code>Module</code></p>
</blockquote>
<p>A cross entropy loss function which will cancel out
    the effect of different class numbers</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's make this adjustment into the loss function, an upgraded version of CrossEntropy</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="c1"># here we change the loss function to MultiTaskCELoss</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">create_softmax_pipeline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">crit</span><span class="o">=</span><span class="n">MultiTaskCELoss</span><span class="p">())</span>\
        <span class="o">.</span><span class="n">test_loss</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="n">inbalanced_input</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">inbl_bias</span><span class="o">=</span><span class="n">b</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_adjusted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_adjusted</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>classes</th>
      <th>loss</th>
      <th>inbl_bias</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>533</td>
      <td>2.319248</td>
      <td>0.208584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2264</td>
      <td>2.326346</td>
      <td>0.022896</td>
    </tr>
    <tr>
      <th>2</th>
      <td>254</td>
      <td>2.320735</td>
      <td>0.922445</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1027</td>
      <td>2.328291</td>
      <td>0.643444</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2428</td>
      <td>2.326136</td>
      <td>0.883795</td>
    </tr>
    <tr>
      <th>5</th>
      <td>772</td>
      <td>2.317071</td>
      <td>0.062716</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2166</td>
      <td>2.315754</td>
      <td>0.364122</td>
    </tr>
    <tr>
      <th>7</th>
      <td>812</td>
      <td>2.321972</td>
      <td>0.852977</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2632</td>
      <td>2.321708</td>
      <td>0.639467</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2576</td>
      <td>2.313269</td>
      <td>0.968200</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1326</td>
      <td>2.321515</td>
      <td>0.508901</td>
    </tr>
    <tr>
      <th>11</th>
      <td>169</td>
      <td>2.321526</td>
      <td>0.870789</td>
    </tr>
    <tr>
      <th>12</th>
      <td>815</td>
      <td>2.309163</td>
      <td>0.262275</td>
    </tr>
    <tr>
      <th>13</th>
      <td>792</td>
      <td>2.321771</td>
      <td>0.608608</td>
    </tr>
    <tr>
      <th>14</th>
      <td>739</td>
      <td>2.316215</td>
      <td>0.198933</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2460</td>
      <td>2.318523</td>
      <td>0.880343</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2420</td>
      <td>2.320517</td>
      <td>0.781538</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1688</td>
      <td>2.316657</td>
      <td>0.954598</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2929</td>
      <td>2.323009</td>
      <td>0.750869</td>
    </tr>
    <tr>
      <th>19</th>
      <td>78</td>
      <td>2.192723</td>
      <td>0.089868</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1670</td>
      <td>2.325608</td>
      <td>0.188055</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2868</td>
      <td>2.324525</td>
      <td>0.058037</td>
    </tr>
    <tr>
      <th>22</th>
      <td>905</td>
      <td>2.319283</td>
      <td>0.126673</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1675</td>
      <td>2.309565</td>
      <td>0.307769</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1430</td>
      <td>2.327099</td>
      <td>0.451335</td>
    </tr>
    <tr>
      <th>25</th>
      <td>424</td>
      <td>2.315844</td>
      <td>0.512538</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1511</td>
      <td>2.316325</td>
      <td>0.613963</td>
    </tr>
    <tr>
      <th>27</th>
      <td>959</td>
      <td>2.330317</td>
      <td>0.987407</td>
    </tr>
    <tr>
      <th>28</th>
      <td>147</td>
      <td>2.325459</td>
      <td>0.931882</td>
    </tr>
    <tr>
      <th>29</th>
      <td>278</td>
      <td>2.317273</td>
      <td>0.401440</td>
    </tr>
    <tr>
      <th>30</th>
      <td>885</td>
      <td>2.325397</td>
      <td>0.087088</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1459</td>
      <td>2.307971</td>
      <td>0.857782</td>
    </tr>
    <tr>
      <th>32</th>
      <td>182</td>
      <td>2.344716</td>
      <td>0.443465</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2468</td>
      <td>2.326825</td>
      <td>0.572978</td>
    </tr>
    <tr>
      <th>34</th>
      <td>954</td>
      <td>2.322750</td>
      <td>0.815261</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1297</td>
      <td>2.319934</td>
      <td>0.887149</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1787</td>
      <td>2.326161</td>
      <td>0.113759</td>
    </tr>
    <tr>
      <th>37</th>
      <td>462</td>
      <td>2.325276</td>
      <td>0.969307</td>
    </tr>
    <tr>
      <th>38</th>
      <td>686</td>
      <td>2.324262</td>
      <td>0.305557</td>
    </tr>
    <tr>
      <th>39</th>
      <td>428</td>
      <td>2.323913</td>
      <td>0.342770</td>
    </tr>
    <tr>
      <th>40</th>
      <td>2900</td>
      <td>2.319349</td>
      <td>0.609161</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2765</td>
      <td>2.323373</td>
      <td>0.296973</td>
    </tr>
    <tr>
      <th>42</th>
      <td>752</td>
      <td>2.320189</td>
      <td>0.302571</td>
    </tr>
    <tr>
      <th>43</th>
      <td>502</td>
      <td>2.325897</td>
      <td>0.419716</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2162</td>
      <td>2.320449</td>
      <td>0.202672</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2460</td>
      <td>2.317962</td>
      <td>0.430931</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2537</td>
      <td>2.312116</td>
      <td>0.693554</td>
    </tr>
    <tr>
      <th>47</th>
      <td>806</td>
      <td>2.318746</td>
      <td>0.539312</td>
    </tr>
    <tr>
      <th>48</th>
      <td>251</td>
      <td>2.322845</td>
      <td>0.181191</td>
    </tr>
    <tr>
      <th>49</th>
      <td>2845</td>
      <td>2.326007</td>
      <td>0.667570</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">df_adjusted</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span>
    <span class="n">df_adjusted</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x131d00bd0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

